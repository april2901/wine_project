<!-- templates/index.html -->
{% extends "layout.html" %}

{% block header %}
  {% if query is defined %}
    "{{ query }}" ê²€ìƒ‰ ê²°ê³¼
  {% else %}
    ë‚´ ì™€ì¸ ë¦¬ìŠ¤íŠ¸
  {% endif %}
{% endblock %}

{% block header_buttons %}
<!-- ê²€ìƒ‰ í¼ -->
<div class="search-container">
  <form action="/search" method="GET" class="search-form">
    <input type="text" name="query" placeholder="ì™€ì¸ ì´ë¦„, êµ­ê°€ ê²€ìƒ‰..." value="{{ query if query is defined else '' }}">
    <button type="submit" class="search-button">ê²€ìƒ‰</button>
  </form>
</div>

<!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ì™€ì¸ ì¶”ê°€ ë²„íŠ¼ í‘œì‹œ -->
{% if session.logged_in %}
<a href="/add" class="add-button">ì™€ì¸ ì¶”ê°€</a>
{% endif %}

{% if query is defined %}
<a href="/" class="back-button">ì „ì²´ ëª©ë¡ìœ¼ë¡œ</a>
{% endif %}
{% endblock %}

{% block content %}
{% if wines %}
<div class="wine-grid">
    {% for wine in wines %}
    <div class="wine-card">
        <div class="wine-name">{{ wine['name'] }}</div>
        
        <div class="wine-details">
            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="wine-info">
                <span class="info-label">êµ­ê°€:</span> {{ wine['country'] }}
                {% if wine['region'] %}
                    <span class="info-divider">|</span> <span class="info-label">ì§€ì—­:</span> {{ wine['region'] }}
                {% endif %}
            </div>
            
            <!-- ì¶”ê°€ ì •ë³´ -->
            <div class="wine-info">
                {% if wine['year'] %}
                    <span class="info-label">ìƒì‚°ë…„ë„:</span> {{ wine['year'] }}
                {% endif %}
                
                {% if wine['grape_variety'] %}
                    <span class="info-divider">|</span> <span class="info-label">í¬ë„í’ˆì¢…:</span> {{ wine['grape_variety'] }}
                {% endif %}
            </div>
            
            <!-- ê°€ê²© ì •ë³´ -->
            {% if wine['price'] %}
            <div class="wine-price">
                <span class="info-label">ê°€ê²©:</span> {{ "{:,}".format(wine['price']) }}ì›
            </div>
            {% endif %}
        </div>
        
        <!-- ë©”ëª¨ -->
        {% if wine['note'] %}
        <div class="wine-note">
            <span class="note-icon">ğŸ“</span> "{{ wine['note'] }}"
        </div>
        {% endif %}
        
        <!-- ì¶”ê°€ ë‚ ì§œ -->
        {% if wine['date_added'] %}
        <div class="wine-date">
            ì¶”ê°€ì¼: {{ wine['date_added'].split()[0] }}
        </div>
        {% endif %}
        
        <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ í¸ì§‘/ì‚­ì œ ë²„íŠ¼ í‘œì‹œ -->
        {% if session.logged_in %}
        <div class="actions">
            <a href="/edit/{{ wine['id'] }}" class="edit-link">ìˆ˜ì •</a>
            <a href="#" class="delete-link" data-id="{{ wine['id'] }}" data-name="{{ wine['name'] }}">ì‚­ì œ</a>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="no-wines">
    {% if query is defined %}
    <p>"{{ query }}" ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    <a href="/">ì „ì²´ ì™€ì¸ ëª©ë¡ ë³´ê¸°</a>
    {% else %}
    <p>ë“±ë¡ëœ ì™€ì¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% if session.logged_in %}
        <a href="/add">"ì™€ì¸ ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì™€ì¸ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</a>
    {% else %}
        <p>ì™€ì¸ì„ ì¶”ê°€í•˜ë ¤ë©´ <a href="/login">ë¡œê·¸ì¸</a>ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
    {% endif %}
    {% endif %}
</div>
{% endif %}
{% endblock %}